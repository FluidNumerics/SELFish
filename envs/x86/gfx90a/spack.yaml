spack:
  specs:
  - feq-parse@2.2.2
  - mpich@4.2.3 +rocm
  - hdf5@1.14.5 +fortran +mpi

  packages:
    all:
      providers:
        mpi: [mpich]
      require: 
        - "target=x86_64_v3"
      prefer: 
        - "amdgpu_target=gfx942"
      hip:
        buildable: false
        externals:
         - spec: "hip@6.4.1"
           prefix: "/opt/rocm"

  container:
    format: docker
    images:
      os: rockylinux:9
      spack: 
        ref: v1.0.2

    strip: true

    labels:
      mpi: mpich
